<class xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" name="DiscordActivity" inherits="RefCounted" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/godotengine/godot/master/doc/class.xsd">
	<brief_description>
	An [DiscordActivity] represents one "thing" a user is doing on Discord and is part of their rich presence.
</brief_description>
	<description>
	Additional information is located on the Discord Developer Portal:
- [url=https://discord.com/developers/docs/rich-presence/overview]https://discord.com/developers/docs/rich-presence/overview[/url]
- [url=https://discord.com/developers/docs/developer-tools/game-sdk#activities]https://discord.com/developers/docs/developer-tools/game-sdk#activities[/url]
- [url=https://discord.com/developers/docs/rich-presence/best-practices]https://discord.com/developers/docs/rich-presence/best-practices[/url]
While RichPresence supports multiple types of activities, the only activity type that is really relevant for the SDK is [enum DiscordActivityTypes.PLAYING]. Additionally, the SDK will only expose Activities that are associated with the current game (or application). So for example, a field like [code]name[/code] below, will always be set to the current game's name from the view of the SDK.
[u][b]Customization[/b][/u]
When an activity shows up on Discord, it will look something like this:
- Playing "game name"
- Capture the flag | 2 - 1
- In a group (2 of 3)
You can control how lines 2 and 3 are rendered in Discord, here's the breakdown:
- Line 1, [code]Playing "game name"[/code] is powered by the name of your game (or application) on Discord.
- Line 2, [code]Capture the flag | 2 - 1[/code] is powered by the [code]details[/code] field in the activity, and this should generally try to describe what the [i]player[/i] is currently doing. You can even include dynamic data such as a match score here.
- Line 3, [code]In a group (2 of 3)[/code] describes the [i]party[/i] the player is in. "Party" is used to refer to a group of players in a shared context, such as a lobby, server, team, etc. The first half, [code]In a group[/code] is powered by the [code]state[/code] field in the activity, and the second half, [code](2 of 3)[/code] is powered by the [code]party[/code] field in the activity and describes how many people are in the current party and how big the party can get.
This diagram visually shows the field mapping:
&lt;image type="html" name="rich_presence.png" width="1070px"&gt;Rich presence field diagram&lt;/image&gt;
You can also specify up to two custom buttons to display on the rich presence. These buttons will open the URL in the user's default browser.
[codeblock lang=text]discordpp::ActivityButton button;
button.SetLabel("Button 1");
button.SetUrl("https://example.com");
activity.AddButton(button);
[/codeblock]
[u][b]Invites / Joinable Activities[/b][/u]
Other users can be invited to join the current player's activity (or request to join it too), but that does require certain fields to be set:
- [DiscordActivityParty] must be set and have a non-empty [method DiscordActivityParty.id] field. All users in the party should set the same id field too!
- [DiscordActivityParty] must specify the size of the group, and there must be room in the group for another person to join.
- [method DiscordActivitySecrets.join] must be set to a non-empty string. The join secret is only shared with users who are accepted into the party by an existing member, so it is truly a secret. You can use this so that when the user is accepted your game knows how to join them to the party. For example it could be an internal game ID, or a Discord lobby ID/secret that the client could join.
There is additional information about game invites here: [url=https://support.discord.com/hc/en-us/articles/115001557452-Game-Invites]https://support.discord.com/hc/en-us/articles/115001557452-Game-Invites[/url]
[u][b]Mobile Invites[/b][/u]
[DiscordActivity] invites are handled via a deep link. To enable users to join your game via an invite in the Discord client, you must do two things:
- Set your deep link URL in the Discord developer portal. This will be available on the General tab of your application once Social Layer integration is enabled for your app.
- Set the desired supported platforms when reporting the activity info in your rich presence, e.g.:
[codeblock lang=text]activity.SetSupportedPlatforms(
    ActivityGamePlatforms.Desktop |
    ActivityGamePlatforms.IOS |
    ActivityGamePlatforms.Android);
[/codeblock]
When the user accepts the invite, the Discord client will open: [code][your url]/_discord/join?secret=[the join secret you set][/code]
[u][b]Example Invites Flow[/b][/u]
If you are using Discord lobbies for your game, a neat flow would look like this:
- When a user starts playing the game, they create a lobby with a random secret string, using [method DiscordClient.create_or_join_lobby]
- That user publishes their RichPresence with the join secret set to the lobby secret, along with party size information
- Another use can then see that RichPresence on Discord and join off of it
- Once accepted the new user receives the join secret and their client can call CreateOrJoinLobby(joinSecret) to join the lobby
- Finally the original user can notice that the lobby membership has changed and so they publish a new RichPresence update containing the updating party size information.
[u][b]Invites Code Example[/b][/u]
[codeblock lang=text]// User A
// 1. Create a lobby with secret
std::string lobbySecret = "foo";
client-&gt;CreateOrJoinLobby(lobbySecret, [=](discordpp::ClientResult result, uint64_t lobbyId) {
    // 2. Update rich presence with join secret
    discordpp::Activity activity{};
    // set name, state, party size ...
    discordpp::ActivitySecrets secrets{};
    secrets.SetJoin(lobbySecret);
    activity.SetSecrets(secrets);
    client-&gt;UpdateRichPresence(std::move(activity), [](discordpp::ClientResult result) {});
});
// 3. Some time later, send an invite
client-&gt;SendActivityInvite(USER_B_ID, "come play with me", [](auto result) {});
// User B
// 4. Monitor for new invites. Alternatively, you can use
// Client::SetActivityInviteUpdatedCallback to get updates on existing invites.
client-&gt;SetActivityInviteCreatedCallback([client](auto invite) {
    // 5. When an invite is received, ask the user if they want to accept it.
    // If they choose to do so then go ahead and invoke AcceptActivityInvite
    client-&gt;AcceptActivityInvite(invite,
        [client](discordpp::ClientResult result, std::string secret) {
        if (result.Successful()) {
            // 5. Join the lobby using the joinSecret
            client-&gt;CreateOrJoinLobby(secret, [](discordpp::ClientResult result, uint64_t
            lobbyId) {
                // Successfully joined lobby!
            });
        }
    });
});
[/codeblock]
[u][b]Join Requests Code Example[/b][/u]
Users can also request to join each others parties. This code snippet shows how that flow might look:
[codeblock lang=text]// User A
// 1. Create a lobby with secret
std::string lobbySecret = "foo";
client-&gt;CreateOrJoinLobby(lobbySecret, [=](discordpp::ClientResult result, uint64_t lobbyId) {
    // 2. Update rich presence with join secret
    discordpp::Activity activity{};
    // set name, state, party size ...
    discordpp::ActivitySecrets secrets{};
    secrets.SetJoin(lobbySecret);
    activity.SetSecrets(secrets);
    client-&gt;UpdateRichPresence(std::move(activity), [](discordpp::ClientResult result) {});
});
// User B
// 3. Request to join User A's party
client-&gt;SendActivityJoinRequest(USER_A_ID, [](auto result) {});
// User A
// Monitor for new invites:
client-&gt;SetActivityInviteCreatedCallback([client](auto invite) {
    // 5. The game can now show that User A has received a request to join their party
    // If User A is ok with that, they can reply back:
    // Note: invite.type will be ActivityActionTypes::JoinRequest in this example
    client-&gt;SendActivityJoinRequestReply(invite, [](auto result) {});
});
// User B
// 6. Same as before, user B can monitor for invites
client-&gt;SetActivityInviteCreatedCallback([client](auto invite) {
    // 7. When an invite is received, ask the user if they want to accept it.
    // If they choose to do so then go ahead and invoke AcceptActivityInvite
    client-&gt;AcceptActivityInvite(invite,
        [client](discordpp::ClientResult result, std::string secret) {
        if (result.Successful()) {
            // 5. Join the lobby using the joinSecret
            client-&gt;CreateOrJoinLobby(secret, [](auto result, uint64_t lobbyId) {
                // Successfully joined lobby!
            });
        }
    });
});
[/codeblock]
</description>
	<tutorials>
	</tutorials>
	<methods>
		<method name="add_button">
			<return type="void" />
			<param index="0" name="button" type="DiscordActivityButton" />
			<description>
			Adds a custom button to the rich presence.
			</description>
		</method>
		<method name="application_id">
			<return type="Variant" />
			<description>
			The application ID of the game that the activity is associated with.
			This field cannot be set by the SDK, and will always be the application ID of the current game or a game from the same publisher.
			Returns [int] or [code]null[/code].
</description>
		</method>
		<method name="assets">
			<return type="Variant" />
			<description>
			Images used to customize how the [DiscordActivity] is displayed in the Discord client.
			Returns [DiscordActivityAssets] or [code]null[/code].
</description>
		</method>
		<method name="details">
			<return type="Variant" />
			<description>
			The state [i]of the what the user is doing[/i] for this activity.
			See the docs on the [DiscordActivity] struct for more info. If specified, must be a string between 2 and 128 characters.
			Returns [String] or [code]null[/code].
</description>
		</method>
		<method name="details_url">
			<return type="Variant" />
			<description>
			A URL that opens when the user clicks/taps the details text.
			See the docs on the [DiscordActivity] struct for more info. If specified, must be a string between 2 and 256 characters.
			Returns [String] or [code]null[/code].
</description>
		</method>
		<method name="equals">
			<return type="bool" />
			<param index="0" name="other" type="DiscordActivity" />
			<description>
			Compares each field of the [DiscordActivity] struct for equality.
			</description>
		</method>
		<method name="get_buttons">
			<return type="DiscordActivityButton[]" />
			<description>
			Returns the custom buttons for the rich presence.
			</description>
		</method>
		<method name="name">
			<return type="String" />
			<description>
			The name of the game or application that the activity is associated with.
			This field defaults to the name of the current game.
			</description>
		</method>
		<method name="parent_application_id">
			<return type="Variant" />
			<description>
			The application ID of the parent application that the activity is associated with if it exists. This is to help identify a collection of games that are from the same publisher.
			This field cannot be set by the SDK, and will always be the application ID of the game's parent or unset if the game has no parent.
			Returns [int] or [code]null[/code].
</description>
		</method>
		<method name="party">
			<return type="Variant" />
			<description>
			The party struct is used to indicate the size and members of the people the current user is playing with.
			Returns [DiscordActivityParty] or [code]null[/code].
</description>
		</method>
		<method name="secrets">
			<return type="Variant" />
			<description>
			The secrets struct is used in combination with the party struct to make an [DiscordActivity] joinable.
			Returns [DiscordActivitySecrets] or [code]null[/code].
</description>
		</method>
		<method name="set_application_id">
			<return type="void" />
			<param index="0" name="application_id" type="Variant" />
			<description>
			Setter for [method DiscordActivity.application_id].
			Parameter [param application_id] can be [int] or [code]null[/code].
</description>
		</method>
		<method name="set_assets">
			<return type="void" />
			<param index="0" name="assets" type="Variant" />
			<description>
			Setter for [method DiscordActivity.assets].
			Parameter [param assets] can be [DiscordActivityAssets] or [code]null[/code].
</description>
		</method>
		<method name="set_details">
			<return type="void" />
			<param index="0" name="details" type="Variant" />
			<description>
			Setter for [method DiscordActivity.details].
			Parameter [param details] can be [String] or [code]null[/code].
</description>
		</method>
		<method name="set_details_url">
			<return type="void" />
			<param index="0" name="details_url" type="Variant" />
			<description>
			Setter for [method DiscordActivity.details_url].
			Parameter [param details_url] can be [String] or [code]null[/code].
</description>
		</method>
		<method name="set_name">
			<return type="void" />
			<param index="0" name="name" type="String" />
			<description>
			Setter for [method DiscordActivity.name].
			</description>
		</method>
		<method name="set_parent_application_id">
			<return type="void" />
			<param index="0" name="parent_application_id" type="Variant" />
			<description>
			Setter for [method DiscordActivity.parent_application_id].
			Parameter [param parent_application_id] can be [int] or [code]null[/code].
</description>
		</method>
		<method name="set_party">
			<return type="void" />
			<param index="0" name="party" type="Variant" />
			<description>
			Setter for [method DiscordActivity.party].
			Parameter [param party] can be [DiscordActivityParty] or [code]null[/code].
</description>
		</method>
		<method name="set_secrets">
			<return type="void" />
			<param index="0" name="secrets" type="Variant" />
			<description>
			Setter for [method DiscordActivity.secrets].
			Parameter [param secrets] can be [DiscordActivitySecrets] or [code]null[/code].
</description>
		</method>
		<method name="set_state">
			<return type="void" />
			<param index="0" name="state" type="Variant" />
			<description>
			Setter for [method DiscordActivity.state].
			Parameter [param state] can be [String] or [code]null[/code].
</description>
		</method>
		<method name="set_state_url">
			<return type="void" />
			<param index="0" name="state_url" type="Variant" />
			<description>
			Setter for [method DiscordActivity.state_url].
			Parameter [param state_url] can be [String] or [code]null[/code].
</description>
		</method>
		<method name="set_status_display_type">
			<return type="void" />
			<param index="0" name="status_display_type" type="Variant" />
			<description>
			Setter for [method DiscordActivity.status_display_type].
			Parameter [param status_display_type] can be [DiscordStatusDisplayTypes.Enum] or [code]null[/code].
</description>
		</method>
		<method name="set_supported_platforms">
			<return type="void" />
			<param index="0" name="supported_platforms" type="int" enum="DiscordActivityGamePlatforms.Enum" />
			<description>
			Setter for [method DiscordActivity.supported_platforms].
			</description>
		</method>
		<method name="set_timestamps">
			<return type="void" />
			<param index="0" name="timestamps" type="Variant" />
			<description>
			Setter for [method DiscordActivity.timestamps].
			Parameter [param timestamps] can be [DiscordActivityTimestamps] or [code]null[/code].
</description>
		</method>
		<method name="set_type">
			<return type="void" />
			<param index="0" name="type" type="int" enum="DiscordActivityTypes.Enum" />
			<description>
			Setter for [method DiscordActivity.type].
			</description>
		</method>
		<method name="state">
			<return type="Variant" />
			<description>
			The state [i]of the party[/i] for this activity.
			See the docs on the [DiscordActivity] struct for more info. If specified, must be a string between 2 and 128 characters.
			Returns [String] or [code]null[/code].
</description>
		</method>
		<method name="state_url">
			<return type="Variant" />
			<description>
			A URL that opens when the user clicks/taps the state text.
			See the docs on the [DiscordActivity] struct for more info. If specified, must be a string between 2 and 256 characters.
			Returns [String] or [code]null[/code].
</description>
		</method>
		<method name="status_display_type">
			<return type="Variant" />
			<description>
			Controls which field is used for the user's status message.
			See the docs on the [DiscordActivity] struct for more info.
			Returns [enum DiscordStatusDisplayTypes.Enum] or [code]null[/code].
</description>
		</method>
		<method name="supported_platforms">
			<return type="int" enum="DiscordActivityGamePlatforms.Enum" />
			<description>
			If an activity is joinable, but only on certain platforms, this field can be used to indicate which platforms the activity is joinable on. For example if a game is available on both PC and Mobile, but PC users cannot join Mobile users and vice versa, this field can be used so that an activity only shows as joinable on Discord if the user is on the appropriate platform.
			</description>
		</method>
		<method name="timestamps">
			<return type="Variant" />
			<description>
			The timestamps struct can be used to render either:
			- a "time remaining" countdown timer (by specifying the [code]end[/code] value)
- a "time elapsed" countup timer (by specifying the [code]start[/code] value)
			Returns [DiscordActivityTimestamps] or [code]null[/code].
</description>
		</method>
		<method name="type">
			<return type="int" enum="DiscordActivityTypes.Enum" />
			<description>
			The type of activity this is.
			This should almost always be set to [code]Playing[/code]
			</description>
		</method>
	</methods>
</class>